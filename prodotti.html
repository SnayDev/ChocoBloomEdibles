<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prodotti | ChocoBloom</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500&display=swap" rel="stylesheet">
</head>
<body>
  <div class="hamburger" onclick="toggleMenu()" aria-label="Menu" tabindex="0">
    <div></div><div></div><div></div>
  </div>
  <header class="navbar">
    <nav class="navbar-inner">
      <div class="navbar-logo-center">
        <a href="index.html">
          <img src="img/mascotte.png" alt="Mascotte navbar" />
        </a>
      </div>
      <ul class="navbar-menu">
        <li><a href="prodotti.html">PRODOTTI</a></li>
        <li><a href="index.html#about">VISIONE</a></li>
        <li><a href="index.html#timeline">STORIA</a></li>
        <li><a href="index.html#footer">CONTATTI</a></li>
      </ul>
    </nav>
    <nav class="side-menu" id="sideMenu">
      <ul>
        <li><a href="prodotti.html">PRODOTTI</a></li>
        <li><a href="index.html#about">VISIONE</a></li>
        <li><a href="index.html#timeline">STORIA</a></li>
        <li><a href="index.html#footer">CONTATTI</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <section class="products-section fadein">
      <h2>I Nostri Edibles</h2>
      <div class="products-grid">
        <div class="product-card wizard-card" data-product="classico" tabindex="0">
          <img src="img/prodotto_classico.png" alt="ChocoBloom Classico 1000mg" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';" />
          <div class="product-info">
            <h3>ChocoBloom Classico 1000mg</h3>
            <p>5 pezzi · 200mg THC per pezzo · 10g cad.</p>
          </div>
        </div>
        <div class="product-card wizard-card" data-product="syrup" tabindex="0">
          <img src="img/prodotto_syrup.png" alt="ChocoBloom Syrup 1000mg" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';" />
          <div class="product-info">
            <h3>ChocoBloom Syrup 1000mg</h3>
            <p>Flacone da 150ml · 1000mg THC totali (~6.7mg/ml)</p>
          </div>
        </div>
      </div>
      <!-- Wizard Details -->
      <div id="wizard-details" class="wizard-details"></div>
    </section>

    <section class="ingredienti-section fadein">
      <h2>Ingredienti Scelti & Certificazioni</h2>
      <div class="ingredienti-list">
        <div class="ingrediente">
          <img src="img/cacao.png" alt="Cacao premium" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';">
          <span>Cacao Criollo BIO</span>
        </div>
        <div class="ingrediente">
          <img src="img/distillato.png" alt="Distillato D9" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';">
          <span>Distillato D9 Californiano</span>
        </div>
        <div class="ingrediente">
          <img src="img/vaniglia.png" alt="Vaniglia naturale" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';">
          <span>Vaniglia Bourbon Naturale</span>
        </div>
        <div class="badge-cert">
          <img src="img/badge-lab.png" alt="Lab tested" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';">
          <span>Lab Tested</span>
        </div>
        <div class="badge-cert">
          <img src="img/badge-bio.png" alt="Biologico" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';">
          <span>Biologico</span>
        </div>
      </div>
    </section>

    <section class="moodboard-section fadein">
      <h2>Moodboard Sensoriale</h2>
      <div class="moodboard-grid">
        <div class="moodboard-item"><img src="img/sensoriale.png" alt="Mood 1" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';"><span>Avvolgente</span></div>
        <div class="moodboard-item"><img src="img/mood2.png" alt="Mood 2" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';"><span>Fiorito</span></div>
        <div class="moodboard-item"><img src="img/mood3.png" alt="Mood 3" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';"><span>Intenso</span></div>
        <div class="moodboard-item"><img src="img/mood4.png" alt="Mood 4" onerror="this.onerror=null;this.src='https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';"><span>Magico</span></div>
      </div>
    </section>

    <section class="faq-section fadein">
      <h2>FAQ</h2>
      <div class="faq-list">
        <div class="faq-item">
          <button class="faq-q">Come vengono prodotti?</button>
          <div class="faq-a">Ogni cioccolatino è artigianale, con ingredienti selezionati e distillato testato in laboratorio.</div>
        </div>
        <div class="faq-item">
          <button class="faq-q">Quanto dura l’effetto?</button>
          <div class="faq-a">L’effetto dura tra 4 e 8 ore, dipende dalla tolleranza personale e dalla dose scelta.</div>
        </div>
        <div class="faq-item">
          <button class="faq-q">Sono legali?</button>
          <div class="faq-a">ChocoBloom, è un marchio registrato in California, e prodotto esclusivamente nello stesso stato, negli USA</div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div>
      <a href="https://t.me/ChocoBloomEdibles_Order" target="_blank">Telegram</a>
      <span>·</span>
      <a href="https://instagram.com/chocobloomedibles" target="_blank">Instagram</a>
    </div>
    <div class="footer-copy">
      © 2025 ChocoBloom. Prodotto in California – Ideato in Italia.
    </div>
    <div class="footer-accessibility">
      <small>Accessibilità: testo ad alto contrasto, navigazione da tastiera, immagini con alt, audio descritto. Sito ottimizzato per mobile e desktop.</small>
    </div>
  </footer>
  <script src="scroll.js"></script>
  <script>
    // Wizard: click prodotto → mostra dettagli e quiz
    const products = {
      classico: {
        name: "ChocoBloom Classico 1000mg",
        descr: "<ul><li>5 cioccolatini artigianali</li><li>200mg THC per pezzo</li><li>10g di cioccolato per pezzo</li><li>Ingredienti: Cacao Criollo BIO, Distillato D9 Californiano, Vaniglia Bourbon Naturale</li></ul>",
        type: "cioccolatino",
        pz: 5,
        mgTot: 1000,
        mgPerPz: 200,
        gPerPz: 10
      },
      syrup: {
        name: "ChocoBloom Syrup 1000mg",
        descr: "<ul><li>Bottiglia da 150ml</li><li>1000mg THC totali</li><li>~6.7mg THC per ml</li><li>Ingredienti: Sciroppo di glucosio, Distillato D9 Californiano, Aromi naturali</li></ul>",
        type: "sciroppo",
        mlTot: 150,
        mgTot: 1000,
        mgPerMl: 1000/150
      }
    };
    // Wizard handler
    document.querySelectorAll('.wizard-card').forEach(card => {
      card.onclick = () => openWizard(card.dataset.product);
      card.onkeydown = e => {if(e.key==='Enter'||e.key===' ') openWizard(card.dataset.product);}
    });

    function openWizard(productKey) {
      const prod = products[productKey];
      let html = `
      <div class="wizard-tree">
        <button class="wizard-close" onclick="closeWizard()">×</button>
        <h3>${prod.name}</h3>
        <div class="wizard-characteristics">${prod.descr}</div>
        <div class="wizard-quiz">
          <form id="dose-wizard-form">
            <label for="wizard-sex">Sesso:</label>
            <select id="wizard-sex" name="sex" required>
              <option value="m">Maschio</option>
              <option value="f">Femmina</option>
              <option value="x">Altro</option>
            </select>
            <label for="wizard-weight">Peso (kg):</label>
            <input type="number" id="wizard-weight" name="weight" min="35" max="180" required>
            <label for="wizard-tolerance">Consumo THC:</label>
            <select id="wizard-tolerance" name="tolerance" required>
              <option value="none">Mai provato</option>
              <option value="low">Saltuario</option>
              <option value="med">Regolare</option>
              <option value="high">Alta tolleranza</option>
            </select>
            <button type="submit" class="cta">Calcola dose</button>
          </form>
          <div id="wizard-dose-result"></div>
          <div class="dose-calc-safety">
            <small>
              Attenzione: i risultati sono solo indicativi. Inizia sempre con la dose minima possibile.<br>
              <b>Mai guidare o svolgere attività a rischio dopo l’assunzione.</b>
            </small>
          </div>
        </div>
      </div>`;
      document.getElementById('wizard-details').innerHTML = html;
      document.body.classList.add("wizard-open");

      // Dose wizard logic
      document.getElementById('dose-wizard-form').onsubmit = function(e) {
        e.preventDefault();
        const weight = parseFloat(this.weight.value);
        const sex = this.sex.value;
        const tolerance = this.tolerance.value;
        let dose = weight * 0.2;
        if(sex === 'f') dose *= 0.85;
        if(sex === 'x') dose *= 0.93;
        if(tolerance === 'none') dose *= 0.5;
        else if(tolerance === 'low') dose *= 0.75;
        else if(tolerance === 'med') dose *= 1;
        else if(tolerance === 'high') dose *= 2;
        dose = Math.round(dose);
        if(dose < 5) dose = 5;
        if(dose > 80) dose = 80;

        let resultText = `<b>Dose consigliata:</b> ${dose}mg THC<br>`;
        if(prod.type==="cioccolatino") {
          let cioc = dose/prod.mgPerPz;
          let ciocTxt = (cioc<1) ? `${Math.round(cioc*10)/10}` : `${Math.floor(cioc)}`; // e.g. 0.5 o 1
          let gr = Math.round((dose/prod.mgPerPz)*prod.gPerPz*10)/10;
          if (cioc < 1) {
            resultText += `<span>≈ ${Math.round(cioc*2)/2} cioccolatino (${gr}g di cioccolato)</span>`;
          } else {
            resultText += `<span>${ciocTxt} cioccolatino/i (${gr}g di cioccolato)</span>`;
          }
        }
        if(prod.type==="sciroppo") {
          let ml = dose/prod.mgPerMl;
          let mlDisp = Math.round(ml*10)/10;
          resultText += `<span>≈ ${mlDisp}ml di syrup</span>`;
        }
        document.getElementById('wizard-dose-result').innerHTML = resultText;
      }
    }
    function closeWizard() {
      document.getElementById('wizard-details').innerHTML = "";
      document.body.classList.remove("wizard-open");
    }

    document.querySelectorAll('.faq-q').forEach(btn => {
      btn.onclick = function() {
        this.classList.toggle("open");
        var ans = this.nextElementSibling;
        ans.style.display = ans.style.display === "block" ? "none" : "block";
      }
    });
  </script>
</body>
</html>
